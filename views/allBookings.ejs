<section class="content">
  <div class="form-inline mb-3">
    <!-- <div class="search-form" style="margin: 20px 0;">
      <input
        class="form-control mr-sm-9"
        type="text"
        placeholder="Search..."
        aria-label="search"
        id="booking-search"
      />
    </div> -->
  </div>

  <table
    id="dtVerticalScrollExample"
    class="table table-striped table-bordered small"
    cellspacing="0"
  >
    <thead>
      <tr>
        <th class="th-sm">Booking ID</th>
        <th class="th-sm">Guest Name</th>
        <th class="th-sm">Room Number</th>
        <th class="th-sm">Room Type</th>
        <th class="th-sm">Check In</th>
        <th class="th-sm">Check Out</th>
        <th class="th-sm">Payment Status</th>
        <th class="th-sm">Created At</th>
        <th class="th-sm">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% if (!bookings || bookings.length === 0) { %>
        <tr>
          <td colspan="9" class="text-center">No bookings found.</td>
        </tr>
      <% } else { %>
        <% bookings.forEach(booking => { %>
          <tr>
            <td><%= booking.id %></td>
            <td><%= booking.guest_name %></td>
            <td><%= booking.room_number %></td>
            <td><%= booking.room_type.charAt(0).toUpperCase() + booking.room_type.slice(1) %></td>
            <td><%
              const checkInDate = booking.check_in instanceof Date
                ? booking.check_in.toISOString().slice(0, 10)
                : typeof booking.check_in === 'string'
                ? booking.check_in.split('T')[0]
                : '';
            %><%= checkInDate %></td>
            <td><%
              const checkOutDate = booking.check_out instanceof Date
                ? booking.check_out.toISOString().slice(0, 10)
                : typeof booking.check_out === 'string'
                ? booking.check_out.split('T')[0]
                : '';
            %><%= checkOutDate %></td>
            <td>
              <% if (booking.payment_status === 'paid') { %>
                <span class="badge badge-success text-uppercase"><%= booking.payment_status %></span>
              <% } else { %>
                <span class="badge badge-warning text-uppercase"><%= booking.payment_status %></span>
              <% } %>
            </td>
            <td><%= booking.created_at ? new Date(booking.created_at).toLocaleString() : 'N/A' %></td>
            <td>
              <a href="/booking/<%= booking.id %>" class="btn btn-sm btn-outline-primary">Edit</a>

            </td>
          </tr>
        <% }) %>
      <% } %>
    </tbody>
  </table>
</section>

<script>
  $(document).ready(function () {
    $('#dtVerticalScrollExample').DataTable({
      scrollY: '200px',
      scrollCollapse: true,
    });
    $('.dataTables_length').addClass('bs-select');

    // Simple client-side search filtering
    $('#booking-search').on('keyup', function () {
      var value = $(this).val().toLowerCase();
      $('#dtVerticalScrollExample tbody tr').filter(function () {
        $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
      });
    });
  });
</script>
